{"version":3,"sources":["../src/utils/totp.ts"],"names":["generateSecret","generateToken","verifyToken","Totp","issuer","account","name","secret","token","verification","undefined","totp"],"mappings":";;;;;AAAA,SAASA,gBAAgBC,eAAeC,mBAAmB;AAE3D,IAAMC,OAAN,6BAAMA,MAAAA;EACGH,eAAeI,QAAgBC,SAAiB;AACrD,WAAOL,eAAe;MACpBM,MAAMF;MACNC;IACF,CAAA;EACF;EAEOH,YAAYK,QAAgBC,OAAe;AAChD,UAAMC,eAAeP,YAAYK,QAAQC,KAAAA;AAEzC,WAAOC,gBAAgBC;EACzB;EAEOT,cAAcM,QAAgB;AACnC,UAAM,EAAEC,MAAK,IAAKP,cAAcM,MAAAA,KAAW,CAAC;AAE5C,WAAOC;EACT;AACF,GAnBA;AAqBO,IAAMG,OAAO,IAAIR,KAAAA","sourcesContent":["import { generateSecret, generateToken, verifyToken } from \"node-2fa\";\n\nclass Totp {\n  public generateSecret(issuer: string, account: string) {\n    return generateSecret({\n      name: issuer,\n      account,\n    });\n  }\n\n  public verifyToken(secret: string, token: string) {\n    const verification = verifyToken(secret, token);\n\n    return verification != undefined;\n  }\n\n  public generateToken(secret: string) {\n    const { token } = generateToken(secret) ?? {};\n\n    return token;\n  }\n}\n\nexport const totp = new Totp();\n"]}