{"version":3,"sources":["../src/service/routes/plugins.ts"],"names":["cors","formBody","helmet","multer","rawBody","registerPlugins","fastify","register","beloBoom","contentParser","field","global","encoding","runFirst","uploadFastifyMulter","options"],"mappings":";;;;;;;;AACA,OAAOA,UAAU;AACjB,OAAOC,cAAc;AACrB,OAAOC,YAAY;AAEnB,OAAOC,YAAY;AAEnB,OAAOC,aAAa;AAOpB,eAAsBC,gBAAgBC,SAAsB;AAiB1DA,UAAQC,SAASP,IAAAA;AAEjBM,UAAQC,SAASL,MAAAA;AAEjBI,UAAQC,SAASN,QAAAA;AAEjBK,UAAQC,SAASC,iBAAAA;AAEjBF,UAAQC,SAASJ,OAAOM,aAAa;AAErC,QAAMH,QAAQC,SAASH,SAAS;IAC9BM,OAAO;IACPC,QAAQ;IACRC,UAAU;IACVC,UAAU;EACZ,CAAA;AACF;AAjCsBR;AAmCf,IAAMS,sBAAsB,wBAACC,YAAsBZ,OAAOY,OAAAA,GAA9B","sourcesContent":["/* import { environment } from \"@belo/utils\"; */\nimport cors from \"@fastify/cors\";\nimport formBody from \"@fastify/formbody\";\nimport helmet from \"@fastify/helmet\";\n/* import rateLimit from \"@fastify/rate-limit\"; */\nimport multer from \"fastify-multer\";\nimport { Options } from \"fastify-multer/lib/interfaces\";\nimport rawBody from \"fastify-raw-body\";\n\n/* import Redis from \"ioredis\"; */\nimport { AppInstance } from \"../types\";\nimport beloBoom from \"./belo-boom\";\n/* import { rateLimitGlobal, rateLimitTo404 } from \"./rate-limit\"; */\n\nexport async function registerPlugins(fastify: AppInstance) {\n  /*   if (!environment.LOCAL) {\n    await fastify.register(\n      rateLimit,\n      rateLimitGlobal(new Redis(environment.REDIS_URL))\n    );\n\n    fastify.setNotFoundHandler(\n      {\n        preHandler: fastify.rateLimit(rateLimitTo404),\n      },\n      function (_request, response) {\n        response.boom.notFound();\n      }\n    );\n  }\n */\n  fastify.register(cors);\n\n  fastify.register(helmet);\n\n  fastify.register(formBody);\n\n  fastify.register(beloBoom);\n\n  fastify.register(multer.contentParser);\n\n  await fastify.register(rawBody, {\n    field: \"rawBody\",\n    global: false,\n    encoding: false,\n    runFirst: true,\n  });\n}\n\nexport const uploadFastifyMulter = (options?: Options) => multer(options);\n"]}